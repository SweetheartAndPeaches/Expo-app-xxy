# WebView å®¹å™¨åº”ç”¨

ä¸€ä¸ªä¸“ä¸šçš„è·¨å¹³å° WebView å®¹å™¨åº”ç”¨ï¼Œå¯ä»¥å°†ä»»æ„ç½‘é¡µåµŒå…¥åˆ°åŸç”Ÿ APP ä¸­ã€‚æ”¯æŒ iOSã€Android å’Œ Web ä¸‰ç«¯ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº **Expo 54 + React Native** çš„ WebView å®¹å™¨åº”ç”¨ï¼Œç”¨äºå°†ç½‘é¡µå†…å®¹æ— ç¼åµŒå…¥åˆ°åŸç”Ÿç§»åŠ¨åº”ç”¨ä¸­ã€‚é€šè¿‡ç®€å•çš„é…ç½®ï¼Œå³å¯å°†ä½ çš„ç½‘é¡µè½¬åŒ–ä¸ºä¸“ä¸šçš„ç§»åŠ¨ APPã€‚

### æ ¸å¿ƒç‰¹æ€§

âœ… **è·¨å¹³å°æ”¯æŒ**ï¼šiOSã€Androidã€Web ä¸‰ç«¯ç»Ÿä¸€
âœ… **çµæ´»é…ç½®**ï¼šURLã€æ ‡é¢˜ã€å›¾æ ‡å‡å¯è‡ªå®šä¹‰
âœ… **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šåŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†ã€è¿”å›é”®æ™ºèƒ½å¤„ç†
âœ… **åŸç”ŸåŠŸèƒ½**ï¼šæ”¯æŒå…¨å±è§†é¢‘ã€Cookieã€JavaScript æ‰§è¡Œ
âœ… **ç¡¬ä»¶åŠ é€Ÿ**ï¼šAndroid å¹³å°ä½¿ç”¨ç¡¬ä»¶æ¸²æŸ“ï¼Œæ€§èƒ½æ›´ä½³
âœ… **æ˜“äºå‘å¸ƒ**ï¼šæ”¯æŒä¸€é”®æ„å»º iOS å’Œ Android ç‰ˆæœ¬

### åº”ç”¨åœºæ™¯

- **ç½‘é¡µè½¬ APP**ï¼šå°†ç°æœ‰ç½‘ç«™å¿«é€Ÿè½¬åŒ–ä¸ºç§»åŠ¨åº”ç”¨
- **å†…å®¹å±•ç¤º**ï¼šå±•ç¤ºæ–‡æ¡£ã€åšå®¢ã€äº§å“ä»‹ç»ç­‰ç½‘é¡µå†…å®¹
- **æ··åˆå¼€å‘**ï¼šä½œä¸ºåŸç”Ÿ APP çš„éƒ¨åˆ†æ¨¡å—ï¼Œå±•ç¤ºç½‘é¡µå†…å®¹
- **å¿«é€ŸåŸå‹**ï¼šå¿«é€ŸéªŒè¯ç½‘é¡µåœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤ºæ•ˆæœ

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- âœ… å®Œæ•´çš„ç½‘é¡µå±•ç¤ºï¼ˆåŸºäº react-native-webviewï¼‰
- âœ… å¯é…ç½®çš„ç½‘é¡µ URL
- âœ… å¯é…ç½®çš„åº”ç”¨æ ‡é¢˜å’Œå›¾æ ‡
- âœ… è¿”å›é”®æ™ºèƒ½å¤„ç†ï¼ˆæ”¯æŒç½‘é¡µå†…å¯¼èˆªå†å²è¿”å›ï¼‰
- âœ… ç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“ï¼ˆAndroid ä½¿ç”¨ç¡¬ä»¶å±‚ï¼‰

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–

- âœ… åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆåŸç”Ÿå¹³å°ï¼‰
- âœ… ç½‘ç»œé”™è¯¯å¤„ç†å’Œé‡è¯•åŠŸèƒ½ï¼ˆåŸç”Ÿå¹³å°ï¼‰
- âœ… è¿”å›é”®æç¤ºï¼ˆåŸç”Ÿå¹³å°ï¼Œå½“å¯ä»¥è¿”å›æ—¶æ˜¾ç¤ºï¼‰
- âœ… æ”¯æŒå…¨å±è§†é¢‘æ’­æ”¾
- âœ… æ”¯æŒå†…è”åª’ä½“æ’­æ”¾
- âœ… æ”¯æŒ Cookie å’Œ DOM å­˜å‚¨
- âœ… æ”¯æŒ JavaScript æ‰§è¡Œ

### å®‰å…¨ä¸å…¼å®¹æ€§

- âœ… HTTPS è¯ä¹¦æ”¯æŒ
- âœ… æ··åˆå†…å®¹æ¨¡å¼ï¼ˆå…¼å®¹æ€§ï¼‰
- âœ… è‡ªåŠ¨ç¼©æ”¾é€‚åº”å±å¹•
- âœ… WebView ç¼“å­˜åŠ é€Ÿ
- âœ… æ”¯æŒæ‰€æœ‰å¿…è¦çš„ç³»ç»Ÿæƒé™

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- pnpm 8+
- Expo CLI
- iOS å¼€å‘ï¼šéœ€è¦ Mac + Xcodeï¼ˆå¯é€‰ï¼Œæ¨èä½¿ç”¨ EAS Buildï¼‰
- Android å¼€å‘ï¼šéœ€è¦ Android Studioï¼ˆå¯é€‰ï¼Œæ¨èä½¿ç”¨ EAS Buildï¼‰

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/SweetheartAndPeaches/Expo-app-xxy.git
cd Expo-app-xxy

# å®‰è£…ä¾èµ–
pnpm install
```

### é…ç½®åº”ç”¨

1. **å¤åˆ¶é…ç½®æ–‡ä»¶**

```bash
cd client
cp .env.example .env
```

2. **ç¼–è¾‘ .env æ–‡ä»¶**

```env
# ç›®æ ‡ç½‘é¡µ URLï¼ˆå¿…éœ€ï¼‰
EXPO_PUBLIC_WEBVIEW_URL=https://your-website.com

# åº”ç”¨åç§°ï¼ˆå¯é€‰ï¼‰
EXPO_PUBLIC_APP_TITLE=æˆ‘çš„åº”ç”¨
```

3. **æ›¿æ¢åº”ç”¨å›¾æ ‡**ï¼ˆå¯é€‰ï¼‰

æ›¿æ¢ä»¥ä¸‹æ–‡ä»¶ï¼š
- `client/assets/images/icon.png` - ä¸»å›¾æ ‡ï¼ˆ1024x1024 åƒç´ ï¼‰
- `client/assets/images/adaptive-icon.png` - Android è‡ªé€‚åº”å›¾æ ‡ï¼ˆ1024x1024 åƒç´ ï¼‰

### è¿è¡Œåº”ç”¨

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆåŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯ï¼‰
coze dev

# æˆ–ä»…å¯åŠ¨å‰ç«¯
cd client
npx expo start
```

é€‰æ‹©è¿è¡Œå¹³å°ï¼š
- æŒ‰ `i` åœ¨ iOS æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œ
- æŒ‰ `a` åœ¨ Android æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œ
- æŒ‰ `w` åœ¨ Web æµè§ˆå™¨ä¸­è¿è¡Œ

## é¡¹ç›®ç»“æ„

```
Expo-app-xxy/
â”œâ”€â”€ client/                     # Expo å‰ç«¯ä»£ç ï¼ˆReact Nativeï¼‰
â”‚   â”œâ”€â”€ app/                    # Expo Router è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ _layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”‚   â””â”€â”€ index.tsx           # é¦–é¡µå…¥å£
â”‚   â”œâ”€â”€ screens/                # é¡µé¢å®ç°
â”‚   â”‚   â””â”€â”€ home/               # WebView ä¸»é¡µé¢
â”‚   â”‚       â”œâ”€â”€ index.tsx       # é¡µé¢ç»„ä»¶
â”‚   â”‚       â””â”€â”€ styles.ts       # é¡µé¢æ ·å¼
â”‚   â”œâ”€â”€ components/             # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ constants/              # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ assets/                 # é™æ€èµ„æº
â”‚   â”œâ”€â”€ app.config.ts           # Expo é…ç½®
â”‚   â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â”œâ”€â”€ package.json            # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ README.md               # å‰ç«¯æ–‡æ¡£
â”œâ”€â”€ server/                     # Express åç«¯ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ index.ts            # åç«¯å…¥å£
â”‚   â””â”€â”€ package.json            # åç«¯ä¾èµ–
â”œâ”€â”€ package.json                # æ ¹ä¾èµ–é…ç½®
â”œâ”€â”€ .coze                       # Coze é…ç½®ï¼ˆç¦æ­¢ä¿®æ”¹ï¼‰
â””â”€â”€ README.md                   # é¡¹ç›®æ–‡æ¡£
```

## é…ç½®è¯´æ˜

### ç½‘é¡µ URL é…ç½®

é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ç›®æ ‡ç½‘é¡µåœ°å€ï¼š

```env
# .env æ–‡ä»¶
EXPO_PUBLIC_WEBVIEW_URL=https://c4e5cb87-e5c1-47fe-a7c4-398d5b9e6a57.dev.coze.site
```

æˆ–ç›´æ¥ä¿®æ”¹ä»£ç ï¼š

```typescript
// client/screens/home/index.tsx
const DEFAULT_CONFIG = {
  url: 'https://your-website.com',
  title: 'æˆ‘çš„åº”ç”¨',
};
```

### åº”ç”¨æ ‡é¢˜é…ç½®

ä¿®æ”¹åº”ç”¨æ˜¾ç¤ºåç§°ï¼š

```typescript
// client/app.config.ts
export default ({ config }: ConfigContext): ExpoConfig => {
  return {
    ...config,
    "name": "æˆ‘çš„åº”ç”¨",  // ä¿®æ”¹è¿™é‡Œ
    // ...
  };
};
```

### åº”ç”¨å›¾æ ‡é…ç½®

æ›¿æ¢ä»¥ä¸‹å›¾æ ‡æ–‡ä»¶ï¼š

- **ä¸»å›¾æ ‡**ï¼š`client/assets/images/icon.png`
  - å°ºå¯¸ï¼š1024x1024 åƒç´ 
  - æ ¼å¼ï¼šPNG
  - ç”¨é€”ï¼šiOS å’Œ Android åº”ç”¨å›¾æ ‡

- **è‡ªé€‚åº”å›¾æ ‡**ï¼š`client/assets/images/adaptive-icon.png`
  - å°ºå¯¸ï¼š1024x1024 åƒç´ 
  - æ ¼å¼ï¼šPNGï¼Œé€æ˜èƒŒæ™¯
  - ç”¨é€”ï¼šAndroid è‡ªé€‚åº”å›¾æ ‡

### Android åŒ…åé…ç½®

```typescript
// client/app.config.ts
export default ({ config }: ConfigContext): ExpoConfig => {
  return {
    ...config,
    "android": {
      "package": "com.yourcompany.webviewapp",  // ä¿®æ”¹è¿™é‡Œ
    },
  };
};
```

åŒ…åæ ¼å¼ï¼š`com.company.appname`

## å¹³å°å·®å¼‚è¯´æ˜

### Web å¹³å°
- ä½¿ç”¨åŸç”Ÿçš„ HTML `iframe` å…ƒç´ å±•ç¤ºç½‘é¡µ
- ä¸éœ€è¦åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆåŠ è½½é€Ÿåº¦å¾ˆå¿«ï¼‰
- ä¸æ”¯æŒè¿”å›é”®å¤„ç†ï¼ˆæµè§ˆå™¨è‡ªå¸¦è¿”å›åŠŸèƒ½ï¼‰
- ä¸æ”¯æŒé”™è¯¯é‡è¯•åŠŸèƒ½ï¼ˆä½¿ç”¨æµè§ˆå™¨åŸç”Ÿé”™è¯¯å¤„ç†ï¼‰

### åŸç”Ÿå¹³å°ï¼ˆiOS/Androidï¼‰
- ä½¿ç”¨ `react-native-webview` ç»„ä»¶å±•ç¤ºç½‘é¡µ
- æ”¯æŒåŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
- æ”¯æŒç½‘ç»œé”™è¯¯å¤„ç†å’Œé‡è¯•
- æ”¯æŒè¿”å›é”®æ™ºèƒ½å¤„ç†
- æ”¯æŒç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“

## å‘å¸ƒåˆ°åº”ç”¨å•†åº—

### iOS å‘å¸ƒ

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒï¼š`client/IOS_PUBLISH_GUIDE.md`

**å¿«é€Ÿæµç¨‹**ï¼š

```bash
# 1. å®‰è£… EAS CLI
npm install -g eas-cli

# 2. é…ç½®é¡¹ç›®
cd client
eas build:configure

# 3. ç™»å½• Apple è´¦å·
eas credentials

# 4. æ„å»º iOS åº”ç”¨
eas build --platform ios --profile production

# 5. æäº¤åˆ° App Store
eas submit --platform ios --latest
```

**è¦æ±‚**ï¼š
- Apple Developer è´¦å·ï¼ˆ$99/å¹´ï¼‰
- åº”ç”¨æˆªå›¾ã€æè¿°ã€éšç§æ”¿ç­–
- ç¬¦åˆ App Store å®¡æ ¸æŒ‡å—

### Android å‘å¸ƒ

```bash
# 1. æ„å»º Android APK
cd client
npx expo build:android

# 2. æ„å»º Android App Bundleï¼ˆæ¨èç”¨äº Google Playï¼‰
npx expo build:android --type app-bundle
```

**è¦æ±‚**ï¼š
- Google Play å¼€å‘è€…è´¦å·ï¼ˆ$25 ä¸€æ¬¡æ€§ï¼‰
- åº”ç”¨å›¾æ ‡å’Œæˆªå›¾
- ç¬¦åˆ Google Play æ”¿ç­–

## å¼€å‘è§„èŒƒ

### è·¯å¾„åˆ«å

Expo é…ç½®äº† `@/` è·¯å¾„åˆ«åæŒ‡å‘ `client/` ç›®å½•ï¼š

```tsx
// æ­£ç¡®
import { Screen } from '@/components/Screen';

// é¿å…ç›¸å¯¹è·¯å¾„
import { Screen } from '../../../components/Screen';
```

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹æ£€æŸ¥
- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª React Hooks è§„èŒƒ
- ç»„ä»¶æ–‡ä»¶ä½¿ç”¨ `useMemo` ä¼˜åŒ–æ ·å¼åˆ›å»º

### ä¾èµ–ç®¡ç†

æ–°å¢ä¾èµ–æ—¶ï¼Œéœ€åœ¨ `client/` æˆ– `server/` ç›®å½•åˆ†åˆ«æ·»åŠ ï¼š

```bash
# æ·»åŠ å‰ç«¯ä¾èµ–
cd client
npx expo install package-name

# æ·»åŠ åç«¯ä¾èµ–
cd server
pnpm add package-name

# åœ¨æ ¹ç›®å½•åŒæ­¥ä¾èµ–
cd /workspace/projects
pnpm install
```

## é«˜çº§é…ç½®

### è‡ªå®šä¹‰ User-Agent

```typescript
// client/screens/home/index.tsx
<WebView
  userAgent="Mozilla/5.0 (Linux; Android 13) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36"
  // ...
/>
```

### ç¦ç”¨ JavaScript

```typescript
<WebView
  javaScriptEnabled={false}
  // ...
/>
```

### ç¦ç”¨ç¼©æ”¾

```typescript
<WebView
  scalesPageToFit={false}
  // ...
/>
```

## å¸¸è§é—®é¢˜

### Q1: WebView æ˜¾ç¤ºä¸å…¨æˆ–å¸ƒå±€é”™ä¹±ï¼Ÿ

**A**: ç¡®ä¿ç›®æ ‡ç½‘é¡µåšäº†ç§»åŠ¨ç«¯é€‚é…ï¼ˆå“åº”å¼è®¾è®¡ï¼‰ï¼Œè®¾ç½®æ­£ç¡®çš„ viewportã€‚

### Q2: è§†é¢‘æ— æ³•æ’­æ”¾ï¼Ÿ

**A**: æ£€æŸ¥è§†é¢‘æ˜¯å¦ä½¿ç”¨ HTML5 æ ‡å‡†æ ¼å¼ï¼ŒURL æ˜¯å¦å¯è®¿é—®ã€‚åº”ç”¨å·²å¯ç”¨å…¨å±è§†é¢‘å’Œå†…è”æ’­æ”¾æ”¯æŒã€‚

### Q3: è¿”å›é”®æ— æ³•é€€å‡ºåº”ç”¨ï¼Ÿ

**A**: åœ¨ WebView å†…è¿”å›åˆ°èµ·å§‹é¡µé¢åï¼Œå†æŒ‰è¿”å›é”®å³å¯é€€å‡ºåº”ç”¨ã€‚

### Q4: å¦‚ä½•è°ƒè¯• WebView ä¸­çš„ç½‘é¡µï¼Ÿ

**A**:
- Chrome DevTools: `chrome://inspect`ï¼ˆä»… Androidï¼‰
- Safari Web Inspector: å¼€å‘ â†’ Simulator â†’ é€‰æ‹©è®¾å¤‡ï¼ˆä»… iOSï¼‰

### Q5: ç½‘é¡µåŠ è½½ç¼“æ…¢ï¼Ÿ

**A**:
- ä½¿ç”¨ CDN åŠ é€Ÿ
- å·²å¯ç”¨ WebView ç¼“å­˜
- ä¼˜åŒ–ç½‘é¡µè‡ªèº«æ€§èƒ½

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Expo 54 + React Native
- **WebView**: react-native-webviewï¼ˆå®˜æ–¹æ¨èï¼‰
- **è·¯ç”±**: Expo Router
- **çŠ¶æ€ç®¡ç†**: React Hooks
- **ç±»å‹æ£€æŸ¥**: TypeScript
- **ä»£ç æ£€æŸ¥**: ESLint
- **åŒ…ç®¡ç†**: pnpm
- **æ„å»ºå·¥å…·**: Expo EAS Build

## æ–‡æ¡£

- [WebView é…ç½®æŒ‡å—](./client/WEBVIEW_CONFIG.md) - è¯¦ç»†é…ç½®è¯´æ˜
- [iOS å‘å¸ƒæŒ‡å—](./client/IOS_PUBLISH_GUIDE.md) - iOS å‘å¸ƒå®Œæ•´æµç¨‹
- [Expo å®˜æ–¹æ–‡æ¡£](https://docs.expo.dev/) - Expo æ¡†æ¶æ–‡æ¡£
- [react-native-webview æ–‡æ¡£](https://github.com/react-native-webview/react-native-webview) - WebView ç»„ä»¶æ–‡æ¡£

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
- æäº¤ Issue
- æŸ¥çœ‹æ–‡æ¡£
- è”ç³»å¼€å‘è€…

---

**Enjoy building your WebView app! ğŸš€**
